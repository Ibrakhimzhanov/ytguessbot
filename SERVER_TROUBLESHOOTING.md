# ๐ง ะฃัััะฐะฝะตะฝะธะต ะฟัะพะฑะปะตะผ ะฝะฐ ัะตัะฒะตัะต ะฟะพัะปะต git pull

## ๐ด ะัะพะฑะปะตะผะฐ: ะะพั ะฝะต ะพัะฒะตัะฐะตั ะฟะพัะปะต git pull

**ะัะธัะธะฝะฐ:** ะกะบะพัะตะต ะฒัะตะณะพ ัะฐะนะป `.env` ะฝะต ะฟะพะฟะฐะป ะฝะฐ ัะตัะฒะตั, ะฟะพัะพะผั ััะพ ะพะฝ ะฒ `.gitignore`!

---

## โ ะะพัะฐะณะพะฒะพะต ัะตัะตะฝะธะต:

### 1๏ธโฃ ะะพะดะบะปััะธัะตัั ะบ ัะตัะฒะตัั:

```bash
ssh root@91.184.247.219
cd /srv/postgres/ytguessbot
```

---

### 2๏ธโฃ ะัะพะฒะตัััะต ััะฐััั PM2:

```bash
pm2 status
```

**ะะถะธะดะฐะตะผัะน ะฒัะฒะพะด:**
```
โโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโโ
โ id  โ name       โ status  โ restart โ uptime  โ cpu      โ
โโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโโโค
โ 0   โ ytguessbot โ online  โ 0       โ 5m      โ 0.1%     โ
โโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโโ
```

**ะัะปะธ status = "errored"** - ะฟะตัะตัะพะดะธัะต ะบ ัะฐะณั 3!

---

### 3๏ธโฃ ะะพัะผะพััะธัะต ะปะพะณะธ ะพัะธะฑะพะบ:

```bash
pm2 logs ytguessbot --lines 50
```

**ะขะธะฟะธัะฝัะต ะพัะธะฑะบะธ:**

#### โ ะัะธะฑะบะฐ 1: "PAYME_X_AUTH is undefined"
```
๐ฐ COURSE_PRICE: NaN
๐ช PAYME_MERCHANT_ID: 
```
**ะัะธัะธะฝะฐ:** ะะตั ัะฐะนะปะฐ `.env`!

#### โ ะัะธะฑะบะฐ 2: "Cannot find module"
```
Error: Cannot find module './payme/payme-utils'
```
**ะัะธัะธะฝะฐ:** ะะต ัััะฐะฝะพะฒะปะตะฝั ะทะฐะฒะธัะธะผะพััะธ ะธะปะธ ะฝะต ัะพะฑัะฐะฝ ะฟัะพะตะบั!

---

### 4๏ธโฃ ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ัะฐะนะปะฐ .env:

```bash
ls -la .env
```

**ะัะปะธ ะฒัะดะฐะตั "No such file"** - ัะฐะนะป `.env` ะพััััััะฒัะตั!

---

### 5๏ธโฃ ะกะะะะะะขะ ัะฐะนะป .env ะฝะฐ ัะตัะฒะตัะต:

```bash
nano .env
```

**ะััะฐะฒััะต ัะปะตะดัััะตะต ัะพะดะตัะถะธะผะพะต:**

```env
# Bot Configuration
BOT_TOKEN=8379068284:AAGm8CkiU7PqcHrURr5-MKpg-XiMfRvur1s

# Admin Configuration
ADMIN_IDS=657967394, 211056631
LOTTERY_ADMIN=ibrakhimzhanovit
OWNER_IDS=657967394

# Base URL
APP_BASE_URL=https://ytacademy.uz

# Database
DATABASE_URL=postgresql://postgres:postgres123@localhost:5432/telegram_course_bot?schema=public

# Payment Configuration (Payme)
# TEST ัะตะถะธะผ:
PAYME_X_AUTH=68dfaed6eb0789cb092fb03e:GjdJQHqcqjYFmZDpjhbM#rXdYAPq7XnB0GyM

# PRODUCTION ัะตะถะธะผ (ะบะพะณะดะฐ ะฟัะพัะตััะธััะตัะต, ัะฐัะบะพะผะผะตะฝัะธััะนัะต):
# PAYME_X_AUTH=68dfaed6eb0789cb092fb03e:34Gsv3pFKZsGXYe2oyAyuzq%b0dxz?UGsg&e

# Course Configuration
COURSE_PRICE=250000000

# Environment
NODE_ENV=production
```

**ะกะพััะฐะฝะธัะต:** `Ctrl+O`, `Enter`, `Ctrl+X`

---

### 6๏ธโฃ ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ (ะตัะปะธ ะฝัะถะฝะพ):

```bash
npm install
```

---

### 7๏ธโฃ ะกะณะตะฝะตัะธััะนัะต Prisma ะบะปะธะตะฝั:

```bash
npm run db:generate
```

---

### 8๏ธโฃ ะกะพะฑะตัะธัะต ะฟัะพะตะบั:

```bash
npm run build
```

**ะ ะปะพะณะฐั ะดะพะปะถะฝะพ ะฟะพัะฒะธัััั:**
```
๐ฐ COURSE_PRICE: 250000000 ัะธะนะธะฝะพะฒ = 2 500 000 ััะผ
๐ช PAYME_MERCHANT_ID: 68dfaed6eb0789cb092fb03e
```

---

### 9๏ธโฃ ะะตัะตะทะฐะฟัััะธัะต PM2:

```bash
pm2 restart ytguessbot
```

---

### ๐ ะัะพะฒะตัััะต ะปะพะณะธ:

```bash
pm2 logs ytguessbot --lines 20
```

**ะะพะปะถะฝะพ ะฟะพัะฒะธัััั:**
```
๐ ะะดะผะธะฝั ะทะฐะณััะถะตะฝั:
๐ Owners: 1
๐ง Admins: 2
๐ฐ COURSE_PRICE: 250000000 ัะธะนะธะฝะพะฒ = 2 500 000 ััะผ
๐ช PAYME_MERCHANT_ID: 68dfaed6eb0789cb092fb03e
๐งช IS_TEST_MODE: false
๐ค ะะฐะฟััะบ Telegram ะฑะพัะฐ...
โ ะะพะดะบะปััะตะฝะธะต ัััะฐะฝะพะฒะปะตะฝะพ!
๐ ะะพั: YT Academy Quiz
๐ ะะฐะฟััะบ ัะตะถะธะผะฐ polling...
```

**โ ะะพั ัะฐะฑะพัะฐะตั!**

---

## ๐ ะะปััะตัะฝะฐัะธะฒะฝะฐั ะฟัะพะฒะตัะบะฐ:

### ะัะพะฒะตัััะต URL ะณะตะฝะตัะฐัะธั:

```bash
curl http://localhost:3000/api/test-payme-url
```

**ะะถะธะดะฐะตะผัะน ะพัะฒะตั:**
```json
{
  "success": true,
  "config": {
    "PAYME_MERCHANT_ID": "68dfaed6eb0789cb092fb03e",
    "COURSE_PRICE": 250000000
  }
}
```

---

## ๐จ ะัะปะธ ะฒัั ะตัั ะฝะต ัะฐะฑะพัะฐะตั:

### 1. ะัะพะฒะตัััะต ะฟะพััั:

```bash
netstat -tulpn | grep node
```

### 2. ะัะพะฒะตัััะต ะพัะธะฑะบะธ ะฒ ะปะพะณะฐั:

```bash
pm2 logs ytguessbot --err --lines 100
```

### 3. ะััะฐะฝะพะฒะธัะต ะธ ะทะฐะฟัััะธัะต ะทะฐะฝะพะฒะพ:

```bash
pm2 delete ytguessbot
pm2 start npm --name ytguessbot -- run bot
pm2 save
```

---

## ๐ ะัััััะน ัะตะบ-ะปะธัั:

- [ ] ะคะฐะนะป `.env` ัััะตััะฒัะตั ะธ ัะพะดะตัะถะธั ะฟัะฐะฒะธะปัะฝัะต ะดะฐะฝะฝัะต
- [ ] `npm install` ะฒัะฟะพะปะฝะตะฝ
- [ ] `npm run db:generate` ะฒัะฟะพะปะฝะตะฝ
- [ ] `npm run build` ััะฟะตัะตะฝ
- [ ] ะ ะปะพะณะฐั ะฒะธะดะฝะพ `PAYME_MERCHANT_ID: 68dfaed6eb0789cb092fb03e`
- [ ] ะ ะปะพะณะฐั ะฒะธะดะฝะพ `COURSE_PRICE: 250000000`
- [ ] PM2 ััะฐััั = "online"
- [ ] ะะพะณะธ ะฝะต ัะพะดะตัะถะฐั ะพัะธะฑะพะบ

---

## ๐ฏ ะัะฝะพะฒะฝะฐั ะฟัะธัะธะฝะฐ ะฟัะพะฑะปะตะผั:

**`.env` ัะฐะนะป ะะ ะะะะะะะะข ะฒ git!**

ะะพะณะดะฐ ะฒั ะดะตะปะฐะตัะต `git pull`, ัะฐะนะป `.env` ะฝะต ะพะฑะฝะพะฒะปัะตััั, ะฟะพัะพะผั ััะพ ะพะฝ ะฒ `.gitignore`.

**ะะตัะตะฝะธะต:** ะกะพะทะดะฐัั `.env` ะฒัััะฝัั ะฝะฐ ัะตัะฒะตัะต (ัะฐะณ 5 ะฒััะต).

---

## โ ะะพัะปะต ะธัะฟัะฐะฒะปะตะฝะธั:

ะะพั ะดะพะปะถะตะฝ:
1. โ ะัะฒะตัะฐัั ะฝะฐ ะบะพะผะฐะฝะดั ะฒ Telegram
2. โ ะะตะฝะตัะธัะพะฒะฐัั ะฟัะฐะฒะธะปัะฝัะต Payme URL
3. โ ะะพะบะฐะทัะฒะฐัั ัะตะฝั 2,500,000 ััะผ
4. โ ะกะพััะฐะฝััั ะบะพะฝัะฐะบัั ะฑะตะท ะพัะธะฑะพะบ

**ะะพัะพะฒะพ!** ๐
